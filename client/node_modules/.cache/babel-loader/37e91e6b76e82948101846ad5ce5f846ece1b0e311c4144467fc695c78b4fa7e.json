{"ast":null,"code":"import React,{useState,useEffect}from\"react\";import axios from\"axios\";import BACKEND_URL from\"../config\";// Use the config\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function Upload(){const[file,setFile]=useState(null);const[title,setTitle]=useState(\"\");const[subject,setSubject]=useState(\"\");const[files,setFiles]=useState([]);const token=localStorage.getItem(\"token\");const fetchFiles=async()=>{try{const res=await axios.get(\"\".concat(BACKEND_URL,\"/files\"),{headers:{Authorization:\"Bearer \".concat(token)}});setFiles(res.data);}catch(err){console.error(\"Fetch files error:\",err);}};useEffect(()=>{fetchFiles();},[]);const handleUpload=async e=>{e.preventDefault();if(!file)return alert(\"Please select a file\");const formData=new FormData();formData.append(\"file\",file);formData.append(\"title\",title);formData.append(\"subject\",subject);try{const res=await axios.post(\"\".concat(BACKEND_URL,\"/upload\"),formData,{headers:{Authorization:\"Bearer \".concat(token),\"Content-Type\":\"multipart/form-data\"}});alert(res.data.message);window.dispatchEvent(new Event(\"fileUploaded\"));// trigger dashboard update\nsetFile(null);setTitle(\"\");setSubject(\"\");fetchFiles();}catch(err){var _err$response,_err$response$data;console.error(\"Upload error:\",err);alert(((_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data=_err$response.data)===null||_err$response$data===void 0?void 0:_err$response$data.message)||\"Upload failed\");}};const handleDelete=async id=>{if(!window.confirm(\"Are you sure you want to delete this file?\"))return;try{const res=await axios.delete(\"\".concat(BACKEND_URL,\"/files/\").concat(id),{headers:{Authorization:\"Bearer \".concat(token)}});alert(res.data.message);window.dispatchEvent(new Event(\"fileUploaded\"));fetchFiles();}catch(err){var _err$response2,_err$response2$data;console.error(\"Delete error:\",err);alert(((_err$response2=err.response)===null||_err$response2===void 0?void 0:(_err$response2$data=_err$response2.data)===null||_err$response2$data===void 0?void 0:_err$response2$data.message)||\"Delete failed\");}};return/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white shadow rounded p-6\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-lg font-semibold mb-4\",children:\"Upload PDF\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleUpload,className:\"space-y-4\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\"application/pdf\",onChange:e=>setFile(e.target.files[0])}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Enter Title\",className:\"border rounded p-2 w-full\",value:title,onChange:e=>setTitle(e.target.value)}),/*#__PURE__*/_jsxs(\"select\",{className:\"border rounded p-2 w-full\",value:subject,onChange:e=>setSubject(e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select Subject\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Python\",children:\"Python\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Java\",children:\"Java\"}),/*#__PURE__*/_jsx(\"option\",{value:\"DBMS\",children:\"DBMS\"}),/*#__PURE__*/_jsx(\"option\",{value:\"OOPS\",children:\"OOPS\"}),/*#__PURE__*/_jsx(\"option\",{value:\"NoSQL\",children:\"NoSQL\"}),/*#__PURE__*/_jsx(\"option\",{value:\"JavaScript\",children:\"JavaScript\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Machine Learning\",children:\"Machine Learning\"})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"bg-blue-500 text-white px-4 py-2 rounded\",children:\"Upload\"})]}),/*#__PURE__*/_jsx(\"h3\",{className:\"mt-6 font-semibold\",children:\"Uploaded Files\"}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-3 grid grid-cols-3 gap-4\",children:files.map(f=>/*#__PURE__*/_jsxs(\"div\",{className:\"p-3 border rounded shadow-sm\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-medium\",children:f.title}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-500\",children:f.subject}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-4 mt-2\",children:[/*#__PURE__*/_jsx(\"a\",{href:\"\".concat(BACKEND_URL,\"/uploads/\").concat(f.filename),target:\"_blank\",rel:\"noopener noreferrer\",className:\"text-blue-500\",children:\"View\"}),/*#__PURE__*/_jsx(\"a\",{href:\"\".concat(BACKEND_URL,\"/files/download/\").concat(f.filename),className:\"text-green-500\",children:\"Download\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleDelete(f.id),className:\"text-red-500 hover:text-red-700\",children:\"Delete\"})]})]},f.id))})]});}export default Upload;","map":{"version":3,"names":["React","useState","useEffect","axios","BACKEND_URL","jsx","_jsx","jsxs","_jsxs","Upload","file","setFile","title","setTitle","subject","setSubject","files","setFiles","token","localStorage","getItem","fetchFiles","res","get","concat","headers","Authorization","data","err","console","error","handleUpload","e","preventDefault","alert","formData","FormData","append","post","message","window","dispatchEvent","Event","_err$response","_err$response$data","response","handleDelete","id","confirm","delete","_err$response2","_err$response2$data","className","children","onSubmit","type","accept","onChange","target","placeholder","value","map","f","href","filename","rel","onClick"],"sources":["C:/Users/yasmi/Downloads/studybuddy/client/src/pages/upload.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport axios from \"axios\";\r\nimport BACKEND_URL from \"../config\"; // Use the config\r\n\r\nfunction Upload() {\r\n  const [file, setFile] = useState(null);\r\n  const [title, setTitle] = useState(\"\");\r\n  const [subject, setSubject] = useState(\"\");\r\n  const [files, setFiles] = useState([]);\r\n  const token = localStorage.getItem(\"token\");\r\n\r\n  const fetchFiles = async () => {\r\n    try {\r\n      const res = await axios.get(`${BACKEND_URL}/files`, {\r\n        headers: { Authorization: `Bearer ${token}` },\r\n      });\r\n      setFiles(res.data);\r\n    } catch (err) {\r\n      console.error(\"Fetch files error:\", err);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchFiles();\r\n  }, []);\r\n\r\n  const handleUpload = async (e) => {\r\n    e.preventDefault();\r\n    if (!file) return alert(\"Please select a file\");\r\n\r\n    const formData = new FormData();\r\n    formData.append(\"file\", file);\r\n    formData.append(\"title\", title);\r\n    formData.append(\"subject\", subject);\r\n\r\n    try {\r\n      const res = await axios.post(`${BACKEND_URL}/upload`, formData, {\r\n        headers: { Authorization: `Bearer ${token}`, \"Content-Type\": \"multipart/form-data\" },\r\n      });\r\n\r\n      alert(res.data.message);\r\n      window.dispatchEvent(new Event(\"fileUploaded\")); // trigger dashboard update\r\n      setFile(null);\r\n      setTitle(\"\");\r\n      setSubject(\"\");\r\n      fetchFiles();\r\n    } catch (err) {\r\n      console.error(\"Upload error:\", err);\r\n      alert(err.response?.data?.message || \"Upload failed\");\r\n    }\r\n  };\r\n\r\n  const handleDelete = async (id) => {\r\n    if (!window.confirm(\"Are you sure you want to delete this file?\")) return;\r\n\r\n    try {\r\n      const res = await axios.delete(`${BACKEND_URL}/files/${id}`, {\r\n        headers: { Authorization: `Bearer ${token}` },\r\n      });\r\n      alert(res.data.message);\r\n      window.dispatchEvent(new Event(\"fileUploaded\"));\r\n      fetchFiles();\r\n    } catch (err) {\r\n      console.error(\"Delete error:\", err);\r\n      alert(err.response?.data?.message || \"Delete failed\");\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"bg-white shadow rounded p-6\">\r\n      <h2 className=\"text-lg font-semibold mb-4\">Upload PDF</h2>\r\n      <form onSubmit={handleUpload} className=\"space-y-4\">\r\n        <input type=\"file\" accept=\"application/pdf\" onChange={(e) => setFile(e.target.files[0])} />\r\n        <input\r\n          type=\"text\"\r\n          placeholder=\"Enter Title\"\r\n          className=\"border rounded p-2 w-full\"\r\n          value={title}\r\n          onChange={(e) => setTitle(e.target.value)}\r\n        />\r\n        <select className=\"border rounded p-2 w-full\" value={subject} onChange={(e) => setSubject(e.target.value)}>\r\n          <option value=\"\">Select Subject</option>\r\n          <option value=\"Python\">Python</option>\r\n          <option value=\"Java\">Java</option>\r\n          <option value=\"DBMS\">DBMS</option>\r\n          <option value=\"OOPS\">OOPS</option>\r\n          <option value=\"NoSQL\">NoSQL</option>\r\n          <option value=\"JavaScript\">JavaScript</option>\r\n          <option value=\"Machine Learning\">Machine Learning</option>\r\n        </select>\r\n        <button type=\"submit\" className=\"bg-blue-500 text-white px-4 py-2 rounded\">Upload</button>\r\n      </form>\r\n\r\n      <h3 className=\"mt-6 font-semibold\">Uploaded Files</h3>\r\n      <div className=\"mt-3 grid grid-cols-3 gap-4\">\r\n        {files.map((f) => (\r\n          <div key={f.id} className=\"p-3 border rounded shadow-sm\">\r\n            <p className=\"font-medium\">{f.title}</p>\r\n            <p className=\"text-sm text-gray-500\">{f.subject}</p>\r\n            <div className=\"flex space-x-4 mt-2\">\r\n              <a href={`${BACKEND_URL}/uploads/${f.filename}`} target=\"_blank\" rel=\"noopener noreferrer\" className=\"text-blue-500\">View</a>\r\n              <a href={`${BACKEND_URL}/files/download/${f.filename}`} className=\"text-green-500\">Download</a>\r\n              <button onClick={() => handleDelete(f.id)} className=\"text-red-500 hover:text-red-700\">Delete</button>\r\n            </div>\r\n          </div>\r\n        ))}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Upload;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}